## 循环语句

 循环语句在不少实际问题中有许多具有规律性的重复操作，因此在程序中就需要重复执行某些语句。一组被重复执行的语句称之为循环体，能否继续重复，决定循环的终止条件。循环结构是在一定条件下反复执行某段程序的流程结构，被反复执行的程序被称为循环体。循环语句是由循环体及循环的终止条件两部分组成的。 下面为您介绍6种循环语法。

### 条件循环<span id ="条件循环"></span>

当条件循环开始后，先判断条件是否满足，如果满足就执行循环体内的语句，执行完毕后再回来判断条件是否满足，如此无限重复，直到条件不满足时，执行先条件后面的语句。

#### 示例：输入一个0到10的数字，判断其是否大于0，若 i 大于0，则 i 进行自减操作，直到不满足条件（即 i = 0），跳出循环。

1. 添加“活动范围”函数，显示名称设置如下：

   ![image-20230607155303148](For.assets/image-20230607155303148.png)

2. 添加“输入对话框”函数，属性设置如下所示：

   ![image-20230607163141837](For.assets/image-20230607163141837.png)

3. 添加“赋值”函数，属性设置结果如下所示：

   ![image-20230607163203519](For.assets/image-20230607163203519.png)

4. 添加“条件循环”函数，显示名称和属性值设置结果如下：

   ![image-20230607163231044](For.assets/image-20230607163231044.png)

5. 在“条件循环”下，依次添加两个“赋值”函数，如下图所示：

   ![image-20230607163251066](For.assets/image-20230607163251066.png)

   创建一个变量 A ，将自减后 i 的值转换为字符串类型，并将转换后的结果赋予变量 A 。变量 A 的创建方法，同条件循环中[变量a](\语法基础\IF.html#变量a)的创建方法一样。

   ![image-20230607163312012](For.assets/image-20230607163312012.png)

6. 添加“日志消息”函数，函数设置结果如下：

   ![image-20230607163326920](For.assets/image-20230607163326920.png)

7. 添加“消息框”函数，函数设置效果如下：

   ![image-20230607163340998](For.assets/image-20230607163340998.png)

8. 待组件编辑完成后，单击【保存】，执行该组件。

9. 执行的结果如下所示：

   ![image-20230607163614557](For.assets/image-20230607163614557.png)

   ![image-20230607163636916](For.assets/image-20230607163636916.png)

   ![image-20230607163648727](For.assets/image-20230607163648727.png)

   ![image-20230607163704019](For.assets/image-20230607163704019.png)

### 遍历循环<span id ="遍历循环"></span>

使用遍历循环可以迭代数组或者一个集合对象，用于循环访问集合以获取所需信息，为数组或对象集合中的每一个元素重复一个嵌入语句组。

#### 示例：遍历输出一个字符串列表里面的内容。

1. 添加“活动范围”函数，显示名称设置如下：

   ![image-20230607115622308](For.assets/image-20230607115622308.png)

2. 添加“构建字符串列表”函数，属性设置如下：

   ![image-20230607115709775](For.assets/image-20230607115709775.png)

3. 添加“遍历循环”函数，属性设置效果如下：

   ![image-20230607115755444](For.assets/image-20230607115755444.png)

4. 在“遍历循环”函数下，依次添加“日志消息”函数，如下所示：

   ![image-20230607115840276](For.assets/image-20230607115840276.png)

   ![image-20230607115854453](For.assets/image-20230607115854453.png)

### FOR循环

使用 “FOR 循环” 可指定本次循环的次数，当执行到设定的最大范围后，退出本次循环。

#### 示例：循环输出数字1到10。

1. 添加“活动范围”函数，函数设置效果如下：

   ![image-20230607121715760](For.assets/image-20230607121715760.png)

2. 添加 “for 循环”函数，函数设置效果如下：

   ![image-20230607121746198](For.assets/image-20230607121746198.png)

3. 添加“赋值”函数，函数设置效果如下：

   ![image-20230607121810244](For.assets/image-20230607121810244.png)

4. 添加“日志消息”函数，函数设置效果如下：

   ![image-20230607121838215](For.assets/image-20230607121838215.png)

5. 待组件编辑完成后，单击【保存】，执行组件。

   ![image-20230607122016995](For.assets/image-20230607122016995.png)

6. 执行结果如下所示：

   ![image-20230607122044881](For.assets/image-20230607122044881.png)

### Continue<span id ="continue"></span>

Continue 是用于跳过本次循环，继续进行下一次循环，即本次循环中 Continue 后面的代码不执行,直接进行下一次循环。

#### 示例：基于上述遍历循环例子，跳过列表中值为“AA” 的记录。

1. 在“遍历循环”函数下方添加 “IF 条件”函数，“IF 条件” 函数的条件设置如图所示：

   ![image-20230607122344114](For.assets/image-20230607122344114.png)

2. 在 “IF 条件”函数下方添加“继续”函数。

3. 待组件编辑完成后，单击【保存】执行组件。

4. 执行结果如图所示：

   ![image-20230607122435685](For.assets/image-20230607122435685.png)

### Break<span id ="break"></span>

 Break 用于跳出循环，即不执行本循环体内的其他语句，直接跳出循环。

#### 示例：基于上述遍历循环例子，找到列表中值为 “BB” 的记录，则跳出循环。

1. 将 “IF 条件”函数的条件设置如下所示：

   ![image-20230607122609845](For.assets/image-20230607122609845.png)

2. 在 “IF 条件”函数下方添加“中断”函数。

   ![image-20230607122644030](For.assets/image-20230607122644030.png)

3. 编辑完组件后，单击“保存”，执行组件。

4. 组件执行的结果如下所示：

   ![image-20230607122715210](For.assets/image-20230607122715210.png)

### repeat循环<span id="repeat循环"></span>

重复执行循环，直到指定的条件为真时结束循环。

【repeat 循环】与【条件循环】的区别：【条件循环】先判断，后执行，而【repeat 循环】先执行后判断。

#### **示例一**（单层循环）：创建一个变量 x，且赋值为1，对 x 进行自加，直到 “x>3” 时结束循环。

1. 在组件编辑面板中，添加【repeat 循环】函数，设置终止循环条件 “x>3” 。

   ![image-20230630094632442](For.assets/image-20230630094632442.png)

2. 在【repeat 循环】下方添加【自加】函数，在该函数中创建变量 x ，且为该变量赋值为1；

   ![image-20230630095225432](For.assets/image-20230630095225432.png)

   ![image-20230630095301462](For.assets/image-20230630095301462.png)

3. 在【自加】函数下方添加【日志消息】函数，且将自加的结果进行输出；

   在消息编辑框中，鼠标右击，选择“显示智能提示”，选择需要输出的变量。

   ![image-20230630095557723](For.assets/image-20230630095557723.png)

4. 执行组件，当满足 “x>3”  时，终止循环，如下图所示：

   ![image-20230630095717749](For.assets/image-20230630095717749.png)

#### **示例二**（嵌套循环）：创建外层循环变量 i ，赋值为1；内层循环变量 j ，赋值为2。 i 和 j 分别进行自加，直到 “j>5” 结束内层循环，“i>1” 结束外层循环。

1. 添加【repeat 循环】函数，设置终止循环条件 “i>1” ；

   ![image-20230630102101615](For.assets/image-20230630102101615.png)

2. 在【repeat 循环】下添加【自加】函数，在该函数中创建变量 i ，且为该变量赋值为1；

   ![image-20230630102814158](For.assets/image-20230630102814158.png)

3. 在【自加】函数下再添加一个【repeat 循环】函数，循环终止条件设置为 “j>5”；

   ![image-20230630103005052](For.assets/image-20230630103005052.png)

4. 在内层的【repeat 循环】下添加【自加】函数，在该函数中创建变量 j ，且为该变量赋值为2；

   ![image-20230630103110392](For.assets/image-20230630103110392.png)

5. 在内层的【自加】函数下，添加【日志消息】函数，将内层的变量 j 的值进行输出；

   ![image-20230630103243104](For.assets/image-20230630103243104.png)

6. 在整个内层【repeat 循环】函数的下方添加【日志消息】函数，将外层的变量 i 的值进行输出；

   ![image-20230630103449594](For.assets/image-20230630103449594.png)

7. 执行组件，当满足 “j>5” 时终止内层循环，当满足 “i>1” 时终止外层循环。

   ![image-20230630103756881](For.assets/image-20230630103756881.png)

### Case&Case Value<span id="case"></span>

Case 语句是 Switch 语句中的一个分支，用于匹配特定的值。
Case 与 Case Value 搭配使用，将会执行第一个与 Case 条件相匹配的 Case Value 分支下的语句，语句执行完成后直接跳出 Case ，不再执行 Case 下的其他 Case Value 分支。

#### 示例一：

嵌套多分支，Case 条件为布尔类型的表达式，Case Value 条件中，0 和 1 表示 “False” 和 “Ture” 。

执行结果：条件满足嵌套语句中的第二个 Case Value 语句，输出该语句下的信息：“a < b，结果为 True” 。

![image-20240308102441603](For.assets/image-20240308102441603.png)

#### 示例二：

循环调用，在条件循环下添加【Case】和【Case Value】函数。为变量 “test” 赋值为1，【条件循环】函数的条件设置为 “test<=5” ,【Case Value】函数条件分别设置为1、2、3、4、6，对变量 “test” 进行自加处理。

执行结果：当 Case Value 条件与 Case 条件相匹配时，执行 Case Value 下的语句，执行完成后跳出 Case 语句，重新执行【条件循环】在重新进入 Case 语句，知道条件不满足【条件循环】时，脚本执行结束。

![image-20240308102500895](For.assets/image-20240308102500895.png)
